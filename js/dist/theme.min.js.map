{"version":3,"sources":["theme.js"],"names":["themeToggle","document","getElementById","themeColors","light","sun","moon","dark","initTheme","prefersDark","savedTheme","localStorage","getItem","window","matchMedia","matches","updateThemeButtonText","currentTheme","body","classList","add","updateIconColors","remove","updateThemeIcons","isDark","console","sunIcons","querySelectorAll","moonIcons","log","concat","length","icon","style","display","opacity","visibility","setAttribute","forEach","colors","transition","btn","color","borderColor","themeTextElements","themeText","textContent","contains","currentLang","isNowDark","wasDark","toggleTheme","detail","Array","from","filter","i","addThemeStyles","CustomEvent","theme","forceIconVisibility","createElement","id","forceTheme","setItem","checkIcons","e","stopPropagation","visible","visibleSun","warn","visibleMoon","floatThemeToggle","resetIcons","addEventListener","cssText","setTimeout","themeDebug","getCurrentTheme","saved","total"],"mappings":"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","file":"theme.min.js","sourcesContent":["// theme.js - Theme switching functionality with colored FontAwesome icons\r\n\r\nconst themeToggle = document.getElementById('themeToggle');\r\nconst floatThemeToggle = document.getElementById('floatThemeToggle');\r\n\r\n// Colors configuration\r\nconst themeColors = {\r\n    light: {\r\n        sun: '#d4af37', // ذهبي للشمس في الوضع الفاتح\r\n        moon: '#666666'  // رمادي للقمر في الوضع الفاتح\r\n    },\r\n    dark: {\r\n        sun: '#666666',  // رمادي للشمس في الوضع الداكن\r\n        moon: '#f0f0f0'  // رمادي فاتح/أبيض للقمر في الوضع الداكن\r\n    }\r\n};\r\n\r\n// Initialize theme\r\nfunction initTheme() {\r\n    const savedTheme = localStorage.getItem('theme') || 'light';\r\n    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;\r\n    \r\n    // Use saved theme, or system preference, or default to light\r\n    let currentTheme;\r\n    \r\n    if (savedTheme === 'system') {\r\n        currentTheme = prefersDark ? 'dark' : 'light';\r\n    } else {\r\n        currentTheme = savedTheme;\r\n    }\r\n    \r\n    // Apply theme\r\n    if (currentTheme === 'dark') {\r\n        document.body.classList.add('dark-theme');\r\n        updateThemeIcons(true);\r\n        updateIconColors(true);\r\n    } else {\r\n        document.body.classList.remove('dark-theme');\r\n        updateThemeIcons(false);\r\n        updateIconColors(false);\r\n    }\r\n    \r\n    // Update theme button text based on current language\r\n    updateThemeButtonText();\r\n    \r\n    return currentTheme;\r\n}\r\n\r\n// Update theme icons visibility - FIXED VERSION\r\nfunction updateThemeIcons(isDark) {\r\n    console.log('Updating theme icons. Is dark?', isDark);\r\n    \r\n    // FIRST: Always show both icons initially, then hide/show based on theme\r\n    const sunIcons = document.querySelectorAll('.fa-sun');\r\n    const moonIcons = document.querySelectorAll('.fa-moon');\r\n    \r\n    console.log(`Found ${sunIcons.length} sun icons and ${moonIcons.length} moon icons`);\r\n    \r\n    // SIMPLE APPROACH: Just toggle visibility\r\n    sunIcons.forEach(icon => {\r\n        if (isDark) {\r\n            icon.style.display = 'none';\r\n            icon.style.visibility = 'hidden';\r\n            icon.style.opacity = '0';\r\n        } else {\r\n            icon.style.display = 'inline-block';\r\n            icon.style.visibility = 'visible';\r\n            icon.style.opacity = '1';\r\n        }\r\n    });\r\n    \r\n    moonIcons.forEach(icon => {\r\n        if (isDark) {\r\n            icon.style.display = 'inline-block';\r\n            icon.style.visibility = 'visible';\r\n            icon.style.opacity = '1';\r\n        } else {\r\n            icon.style.display = 'none';\r\n            icon.style.visibility = 'hidden';\r\n            icon.style.opacity = '0';\r\n        }\r\n    });\r\n    \r\n    // BETTER APPROACH: Use data attributes\r\n    sunIcons.forEach(icon => {\r\n        icon.setAttribute('data-theme', isDark ? 'hidden' : 'visible');\r\n    });\r\n    \r\n    moonIcons.forEach(icon => {\r\n        icon.setAttribute('data-theme', isDark ? 'visible' : 'hidden');\r\n    });\r\n}\r\n\r\n// Update icon colors based on theme\r\nfunction updateIconColors(isDark) {\r\n    const colors = isDark ? themeColors.dark : themeColors.light;\r\n    \r\n    // Update sun icons color - always update even if hidden\r\n    document.querySelectorAll('.fa-sun').forEach(icon => {\r\n        icon.style.color = colors.sun;\r\n        icon.style.transition = 'color 0.3s ease, opacity 0.3s ease';\r\n    });\r\n    \r\n    // Update moon icons color - always update even if hidden\r\n    document.querySelectorAll('.fa-moon').forEach(icon => {\r\n        icon.style.color = colors.moon;\r\n        icon.style.transition = 'color 0.3s ease, opacity 0.3s ease';\r\n    });\r\n    \r\n    // Update theme toggle button colors\r\n    const themeButtons = document.querySelectorAll('.theme-btn, .float-theme');\r\n    themeButtons.forEach(btn => {\r\n        btn.style.transition = 'all 0.3s ease';\r\n        \r\n        if (isDark) {\r\n            // Dark theme button styling\r\n            btn.style.color = colors.moon;\r\n            btn.style.borderColor = colors.moon;\r\n        } else {\r\n            // Light theme button styling\r\n            btn.style.color = colors.sun;\r\n            btn.style.borderColor = colors.sun;\r\n        }\r\n    });\r\n}\r\n\r\n// Update theme button text\r\nfunction updateThemeButtonText() {\r\n    const themeTextElements = document.querySelectorAll('.theme-text');\r\n    if (themeTextElements.length === 0) return;\r\n    \r\n    const isDark = document.body.classList.contains('dark-theme');\r\n    const currentLang = localStorage.getItem('language') || 'ar';\r\n    \r\n    themeTextElements.forEach(themeText => {\r\n        // Update text\r\n        if (currentLang === 'ar') {\r\n            themeText.textContent = isDark ? 'داكن' : 'فاتح';\r\n        } else {\r\n            themeText.textContent = isDark ? 'Dark' : 'Light';\r\n        }\r\n        \r\n        // Update text color based on theme\r\n        if (isDark) {\r\n            themeText.style.color = themeColors.dark.moon;\r\n        } else {\r\n            themeText.style.color = themeColors.light.sun;\r\n        }\r\n    });\r\n}\r\n\r\n// Toggle theme\r\nfunction toggleTheme() {\r\n    const wasDark = document.body.classList.contains('dark-theme');\r\n    const isNowDark = !wasDark;\r\n    \r\n    console.log(`Toggling theme from ${wasDark ? 'dark' : 'light'} to ${isNowDark ? 'dark' : 'light'}`);\r\n    \r\n    if (isNowDark) {\r\n        // Switch to dark theme\r\n        document.body.classList.add('dark-theme');\r\n        localStorage.setItem('theme', 'dark');\r\n        console.log('Switched to dark theme - should show moon, hide sun');\r\n    } else {\r\n        // Switch to light theme\r\n        document.body.classList.remove('dark-theme');\r\n        localStorage.setItem('theme', 'light');\r\n        console.log('Switched to light theme - should show sun, hide moon');\r\n    }\r\n    \r\n    // Update UI elements\r\n    updateThemeIcons(isNowDark);\r\n    updateIconColors(isNowDark);\r\n    updateThemeButtonText();\r\n    \r\n    // Log icon status for debugging\r\n    setTimeout(() => {\r\n        const sunIcons = document.querySelectorAll('.fa-sun');\r\n        const moonIcons = document.querySelectorAll('.fa-moon');\r\n        console.log(`After toggle: Sun icons visible: ${Array.from(sunIcons).filter(i => i.style.display !== 'none').length}`);\r\n        console.log(`After toggle: Moon icons visible: ${Array.from(moonIcons).filter(i => i.style.display !== 'none').length}`);\r\n    }, 100);\r\n    \r\n    // Trigger custom event for theme change\r\n    window.dispatchEvent(new CustomEvent('themeChanged', { \r\n        detail: { \r\n            isDark: isNowDark,\r\n            theme: isNowDark ? 'dark' : 'light'\r\n        } \r\n    }));\r\n}\r\n\r\n// Add CSS styles for theme icons - SIMPLIFIED VERSION\r\nfunction addThemeStyles() {\r\n    if (!document.getElementById('theme-icon-styles')) {\r\n        const style = document.createElement('style');\r\n        style.id = 'theme-icon-styles';\r\n        style.textContent = `\r\n            /* Theme icon base styles */\r\n            .theme-btn i, .float-theme i {\r\n                transition: all 0.3s ease !important;\r\n                font-size: 1.2rem !important;\r\n                display: inline-block !important;\r\n            }\r\n            \r\n            /* Ensure proper icon display */\r\n            .fa-sun, .fa-moon {\r\n                display: inline-block !important;\r\n                transition: opacity 0.3s ease, visibility 0.3s ease !important;\r\n            }\r\n            \r\n            /* Light theme - show sun, hide moon */\r\n            body:not(.dark-theme) .fa-sun {\r\n                display: inline-block !important;\r\n                visibility: visible !important;\r\n                opacity: 1 !important;\r\n                color: ${themeColors.light.sun} !important;\r\n            }\r\n            \r\n            body:not(.dark-theme) .fa-moon {\r\n                display: none !important;\r\n                visibility: hidden !important;\r\n                opacity: 0 !important;\r\n                color: ${themeColors.light.moon} !important;\r\n            }\r\n            \r\n            /* Dark theme - show moon, hide sun */\r\n            body.dark-theme .fa-sun {\r\n                display: none !important;\r\n                visibility: hidden !important;\r\n                opacity: 0 !important;\r\n                color: ${themeColors.dark.sun} !important;\r\n            }\r\n            \r\n            body.dark-theme .fa-moon {\r\n                display: inline-block !important;\r\n                visibility: visible !important;\r\n                opacity: 1 !important;\r\n                color: ${themeColors.dark.moon} !important;\r\n            }\r\n            \r\n            /* Theme text styling */\r\n            .theme-text {\r\n                transition: color 0.3s ease;\r\n                font-weight: 500;\r\n                margin-right: 8px;\r\n            }\r\n            \r\n            /* Theme button hover effects */\r\n            .theme-btn:hover i, .float-theme:hover i {\r\n                transform: scale(1.1);\r\n            }\r\n            \r\n            /* Floating theme button */\r\n            .float-theme {\r\n                background: var(--card-bg) !important;\r\n                border: 2px solid !important;\r\n                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1) !important;\r\n                transition: all 0.3s ease !important;\r\n            }\r\n            \r\n            body:not(.dark-theme) .float-theme {\r\n                border-color: ${themeColors.light.sun} !important;\r\n                color: ${themeColors.light.sun} !important;\r\n            }\r\n            \r\n            body.dark-theme .float-theme {\r\n                border-color: ${themeColors.dark.moon} !important;\r\n                color: ${themeColors.dark.moon} !important;\r\n            }\r\n        `;\r\n        document.head.appendChild(style);\r\n        console.log('Added theme icon styles');\r\n    }\r\n}\r\n\r\n// Emergency fix for icon visibility\r\nfunction forceIconVisibility() {\r\n    const isDark = document.body.classList.contains('dark-theme');\r\n    console.log('Force fixing icon visibility. Current theme:', isDark ? 'dark' : 'light');\r\n    \r\n    // Remove all inline styles that might be hiding icons\r\n    document.querySelectorAll('.fa-sun, .fa-moon').forEach(icon => {\r\n        icon.style.cssText = ''; // Clear all inline styles\r\n    });\r\n    \r\n    // Re-apply theme\r\n    updateThemeIcons(isDark);\r\n    updateIconColors(isDark);\r\n}\r\n\r\n// Initialize on DOM loaded\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n    console.log('Initializing theme system...');\r\n    \r\n    // Add theme styles\r\n    addThemeStyles();\r\n    \r\n    // Initialize theme\r\n    initTheme();\r\n    \r\n    // Emergency fix after a short delay\r\n    setTimeout(forceIconVisibility, 500);\r\n    \r\n    // Add event listeners to theme toggles\r\n    if (themeToggle) {\r\n        themeToggle.addEventListener('click', function(e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            console.log('Main theme button clicked');\r\n            toggleTheme();\r\n            // Force fix after toggle\r\n            setTimeout(forceIconVisibility, 100);\r\n        });\r\n        console.log('Main theme toggle button initialized');\r\n    } else {\r\n        console.warn('Main theme toggle button not found');\r\n    }\r\n    \r\n    if (floatThemeToggle) {\r\n        floatThemeToggle.addEventListener('click', function(e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            console.log('Floating theme button clicked');\r\n            toggleTheme();\r\n            // Force fix after toggle\r\n            setTimeout(forceIconVisibility, 100);\r\n        });\r\n        console.log('Floating theme toggle button initialized');\r\n    } else {\r\n        console.warn('Floating theme toggle button not found');\r\n    }\r\n    \r\n    // Listen for system theme changes\r\n    const darkModeMediaQuery = window.matchMedia('(prefers-color-scheme: dark)');\r\n    darkModeMediaQuery.addEventListener('change', function(e) {\r\n        const savedTheme = localStorage.getItem('theme');\r\n        if (savedTheme === 'system') {\r\n            console.log('System theme changed to:', e.matches ? 'dark' : 'light');\r\n            initTheme();\r\n            forceIconVisibility();\r\n        }\r\n    });\r\n    \r\n    // Listen for language changes to update button text\r\n    window.addEventListener('languageChanged', function() {\r\n        console.log('Language changed, updating theme button...');\r\n        updateThemeButtonText();\r\n    });\r\n});\r\n\r\n// Make functions available globally\r\nwindow.initTheme = initTheme;\r\nwindow.toggleTheme = toggleTheme;\r\nwindow.updateThemeButtonText = updateThemeButtonText;\r\nwindow.updateIconColors = updateIconColors;\r\nwindow.forceIconVisibility = forceIconVisibility;\r\n\r\n// Debug function\r\nwindow.themeDebug = {\r\n    getCurrentTheme: function() {\r\n        const isDark = document.body.classList.contains('dark-theme');\r\n        return {\r\n            theme: isDark ? 'dark' : 'light',\r\n            colors: isDark ? themeColors.dark : themeColors.light,\r\n            saved: localStorage.getItem('theme') || 'light'\r\n        };\r\n    },\r\n    forceTheme: function(theme) {\r\n        console.log('Debug: Forcing theme to', theme);\r\n        if (theme === 'dark') {\r\n            document.body.classList.add('dark-theme');\r\n            localStorage.setItem('theme', 'dark');\r\n        } else {\r\n            document.body.classList.remove('dark-theme');\r\n            localStorage.setItem('theme', 'light');\r\n        }\r\n        forceIconVisibility();\r\n        updateThemeButtonText();\r\n    },\r\n    checkIcons: function() {\r\n        const sunIcons = document.querySelectorAll('.fa-sun');\r\n        const moonIcons = document.querySelectorAll('.fa-moon');\r\n        \r\n        const visibleSun = Array.from(sunIcons).filter(i => \r\n            i.style.display !== 'none' && \r\n            i.style.visibility !== 'hidden' && \r\n            i.style.opacity !== '0'\r\n        ).length;\r\n        \r\n        const visibleMoon = Array.from(moonIcons).filter(i => \r\n            i.style.display !== 'none' && \r\n            i.style.visibility !== 'hidden' && \r\n            i.style.opacity !== '0'\r\n        ).length;\r\n        \r\n        console.log(`Sun icons: ${sunIcons.length} total, ${visibleSun} visible`);\r\n        console.log(`Moon icons: ${moonIcons.length} total, ${visibleMoon} visible`);\r\n        \r\n        sunIcons.forEach((icon, i) => {\r\n            console.log(`Sun ${i+1}: display=${icon.style.display}, visibility=${icon.style.visibility}, opacity=${icon.style.opacity}`);\r\n        });\r\n        \r\n        moonIcons.forEach((icon, i) => {\r\n            console.log(`Moon ${i+1}: display=${icon.style.display}, visibility=${icon.style.visibility}, opacity=${icon.style.opacity}`);\r\n        });\r\n        \r\n        return { sun: { total: sunIcons.length, visible: visibleSun }, \r\n                moon: { total: moonIcons.length, visible: visibleMoon } };\r\n    },\r\n    resetIcons: function() {\r\n        console.log('Debug: Resetting all icon styles');\r\n        document.querySelectorAll('.fa-sun, .fa-moon').forEach(icon => {\r\n            icon.style.cssText = '';\r\n        });\r\n        forceIconVisibility();\r\n    }\r\n};"]}